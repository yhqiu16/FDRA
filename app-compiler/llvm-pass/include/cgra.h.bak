#ifndef CGRA_
#define CGRA_

#include <iostream>
#include <string>

using namespace std;
struct cfg_config
{
    unsigned short int cfg_data1;
    unsigned short int cfg_data2;
    unsigned short int cfg_base_addr;
};

struct port
{
    int origin_ports;
    int index;
    int io; //1 means output, 0 means input
};

class CGRA
{
private:
    cfg_config* cin; //
    port* io_ports; //
    int* addrs; //
    int config_num; //
    int port_num; //
    int config_len; //
    int config_addr; //
    int config_port; //
    int sizeofBank; //
    int mem_in_group; //
    static int recent_addrs[8];
    static int last_addrs[8];
    unsigned int iob_ens; //
public:
    CGRA(string config_file, string dfgio_file, string Parameter_file);
    CGRA(const CGRA &);
    CGRA & operator=(const CGRA &);
    ~CGRA();
    int* Getaddrs();
    int Getcfgnum();
    int Getcfglen();
    int Getcfgadd();
    unsigned int Getens();
    port* Getports();
    cfg_config* Getcin();
    void Printcin();
    void Printports();
    void run(int *din[], int *dout[], int data_len, int task_id);
};

#endif